# CompilerTree
编译技术

![](https://i.imgur.com/qtjTAOc.png)


<pre>
词法分析：
       词法分析的任务是：
                      输入源程序，对构成源程序的字符串进行扫描和分析，识别出一个个
               单词（定义符，标识符，运算符，界符，常数）

       词法分析所遵循的是语言的语法规则。
       描述语法规则的有效工具是正则式和有限自动机。
</pre>

<pre>
语法分析：
       语法分析的任务是：
                      在词法分析的基础上，根据语言的语法规则，把单词符号串分解成各类语法
               单元（短语，子句，句子，程序段，程序），并确定整个输入串是否构成语法上正确
               的程序

       语法分析所遵循的是语法规则。
       语法规则通常用上下文无关文法描述。
       词法分析是一种线性分析，而语法分析是一种层次结构分析。
</pre>

<pre>
语义分析和中间代码的生成：
       这一阶段的任务是：
                      对语法分析所识别出的各类语法范畴，分析其含义，并进行初步翻译
               （产生中间代码），这一阶段通常包括两个方面的工作：
                      1）对每种语法范畴进行静态语义的检查，例如：变量是否定义，类型是否
                         正确等。
                      2）如果语义是正确的则进行中间代码的翻译
       这一阶段所遵循的是语言的语义规则，通常使用属性文法描述语义规则。
</pre>

<pre>
代码：
       对于代码（主要是中间代码）进行加工变换，以期能够产生更为高效（节省时间和空间）的目标代码。
       优化的主要方面有：
                      1）公共子表达式的提取
                      2）循环优化
                      3）删除无用代码

       优化所遵循的是程序的等价变换规则。
</pre>

<pre>
目标代码生成：
       这一阶段的任务是：
                      把中间代码（经过优化处理之后的）变换成特定机器上的低级语言代码（如汇编指令）
</pre>

<pre>
编译前端VS编译后端
       1）前端编译
          把Java源码文件编译成Class文件的过程。
          
          优点：
              这阶段的优化是程序编码方面的；
              许多Java语法新特性(语法糖：泛型，内部类)是靠前端编译器实现的，而不是依赖虚拟机。
              编译成的Class文件可以直接给JVM解释执行，省去了编译时间，加快启动速度。

          缺点：
              对代码运行的效率几乎没有任何优化措施
              解释执行的效率较低，所以需要结合JIT编译

          前端编译器：
              javac

       2）后端编译（JIT编译）
          
          通过Java虚拟机内置的即时编译器(JIT编译器)，在运行时把class文件字节码编译成本地机器码的
          过程。

          优点：
              通过在运行时收集监控信息，把热点代码编译成与本地平台相关的机器码，并进行各种层次的优化。

              可以大大提高执行效率。

          缺点：
              收集监控信息影响程序运行。
              编译过程占用程序运行时间。
              编译机器码占用内存。

          JIT编译器：
                   HotSpot虚拟机的C1, C2编译器。

          JIT编译器编译速度及编译结果的优劣是衡量一个JVM性能的很重要的指标。
          所以对程序运行性能优化集中到这个阶段；
          可以对这个阶段进行JVM调优。
</pre>

<pre>
Java体系
      目前Java体系中主要还是采用前端编译 + JIT编译的方式，如JDK中的HotSpot虚拟机。
      前端编译 + JIT编译方式的运作过程如下：
           1）通过前端编译把符合Java语言规范的程序代码转化为满足JVM规范所要求的Class格式。
           2）程序启动时,Class文件发挥作用，解释执行，省去编译时间，加快启动速度。
           3）针对Class解释执行效率低的问题，在运行中收集性能监控信息，得知“热点代码”
           5）JIT逐渐发挥作用，把越来越多的热点代码“编译优化成本地代码”，提高执行效率
</pre>
